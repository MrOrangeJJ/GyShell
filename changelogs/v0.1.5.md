# v0.1.5 Release Notes

### English

**Thinking Chain Support**

- **Implemented thinking chain extraction** with compatibility across most API provider thinking formats.
- **Added a Debug Mode option** to persist raw response payloads for troubleshooting while keeping normal runtime behavior unchanged.
- **Removed the built-in `think` tool** since it is no longer used.
- **Renamed built-in tool `send_char` to `write_stdin`** (description and parameters remain unchanged), and updated all related prompt/doc references.

**Task Completion Reliability**

- **Added a task completion guard** to prevent the agent from ending too early.
- **Improved long-running task continuity** so extended workflows can continue reliably before finalizing.
- **Added runtime trajectory constraint reflection**: every 8 passes through `model_request`, a background thinking-model audit runs in parallel to judge whether the current approach is still reasonable.
- **If the audit detects off-track execution**, it generates a corrective constraint and injects it as an internal message before a later `model_request` step (without streaming or polluting normal message history).

**Experimental Feature Toggles**

- **Added an `Experimental Features` subsection under General settings** with two switches:
  - `Runtime Thinking Reflection Correction`
  - `Task Finish Guard`
- **Both switches are enabled by default**.
- **Switch effects are session-window locked** (same lifecycle as session-locked model profile): once a session is busy, the selected behavior remains stable until `SESSION_READY`.

**Session-Bound Model Profile**

- **Model profile is now locked to the running session window** (not per single agent run).
- **Inserted follow-up input during an active session now keeps using the same locked profile**.
- **Profile selector is disabled while a session is busy**, showing the session-locked profile.
- **When the session is fully ready again (`SESSION_READY`)**, the lock is released and selector returns to current global profile.

---

### 中文 (Chinese)

**思维链支持**

- **实现了思维链提取能力**，兼容大多数 API Provider 的思维链输出格式。
- **新增 Debug Mode 开关**，可在调试时保留原始响应数据，且不影响正常运行逻辑。
- **移除了内置 `think` 工具**（该工具已不再使用）。
- **将内置工具 `send_char` 更名为 `write_stdin`**（描述与参数保持不变），并同步更新了所有相关 prompt 与文档引用。

**任务完成可靠性**

- **新增任务完成守卫（task completion guard）**，避免任务过早结束。
- **优化超长任务连续执行能力**，让长流程在收尾前可更稳定地持续运行。
- **新增运行时轨迹约束反思机制**：每经过 `model_request` 8 次，会并行触发后台 thinking model 审计，判断当前执行路径是否仍然合理。
- **若审计判定路径偏离**，会生成纠正约束，并在后续一次 `model_request` 前以内部消息注入（不走前端 stream，也不污染正常消息历史）。

**试验性功能开关**

- **在 General 设置中新增 `试验性功能` 子项**，包含两个开关：
  - `运行时思考反思纠正`
  - `任务结束守卫`
- **两个开关默认开启**。
- **开关影响范围采用 session 窗口锁定语义**（与 session 锁定模型 Profile 生命周期一致）：session busy 后行为保持稳定，直到 `SESSION_READY` 才释放。

**Session 级模型配置绑定**

- **模型 Profile 现在会绑定到运行中的 session 窗口**（不是单次 agent run 级别）。
- **session 运行中插入输入（inserted）会继续沿用该 session 已锁定的 Profile**。
- **session busy 期间前端 Profile 选择器会被禁用**，并显示当前 session 锁定的 Profile。
- **当 session 完整进入 `SESSION_READY` 后**，锁定释放，选择器恢复到当前全局 Profile。
